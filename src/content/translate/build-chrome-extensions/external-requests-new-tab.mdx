---
type: 'Post'
date: '2022-08-24 11:40:06'
title: 'Chromeæ’ä»¶å¼€å‘ - External requests'
tags: [chrome]
description: åŸºäºreactã€tailwindcsså¼€å‘è‡ªå·±çš„chromeæ’ä»¶
cover: https://cdn.jsdelivr.net/gh/manonicu/pics@master/uPic/CxW8Dv.jpg
---

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„æµè§ˆå™¨æ’ä»¶å·²ç»å…·å¤‡äº†å†…å®¹å±•ç¤ºå’Œäº¤äº’ã€‚

æ¥ä¸‹æ¥ä¸ºæµè§ˆå™¨æ·»åŠ ä¸€äº›å…¶ä»–çš„è¯·æ±‚æ•°æ®ã€‚

## Weather API

æ‰“å¼€[OpenWeather](https://openweathermap.org/)ï¼Œæ³¨å†Œã€ç™»å½•ï¼Œç„¶åç”³è¯· apiï¼Œå¦‚å›¾ï¼š

![BkjOBD](https://cdn.jsdelivr.net/gh/manonicu/pics@master/uPic/BkjOBD.jpg)

æ·»åŠ `.env`æ–‡ä»¶ï¼Œå°†ç”³è¯·çš„ api å†™å…¥

```bash
VITE_APP_API_URL='https://api.openweathermap.org/data/2.5'
VITE_APP_API_KEY='YOUR_KEY'
```

åˆ›å»º`Weather.jsx`

```jsx
export default function Weather() {
  return (
    <div>
      <h2>The weather today â˜ï¸</h2>
    </div>
  )
}
```

åœ¨`App.jsx`ç»„ä»¶å†…å¼•å…¥`Weather.jsx`

```jsx
import Counter from './Counter'
import Weather from './Weather'

export function App() {
  return (
    <div className="flex flex-col items-center justify-center w-screen h-screen bg-indigo-400 text-6xl font-bold text-white">
      <p>Welcome ğŸ‘‹</p>
      <br />
      <Weather />
      <br />
      <Counter />
    </div>
  )
}
```

åœ¨`Weather.jsx`å¼•å…¥ hooks çŠ¶æ€

```jsx
import {useEffect, useState} from 'react'

export default function Weather() {
  const [latLng, setLatLng] = useState({})
  const [data, setData] = useState(null)

  useEffect(() => {
    if (!latLng.lat && !latLng.long) {
      navigator.geolocation.getCurrentPosition(function (position) {
        setLatLng({
          lat: position.coords.latitude,
          long: position.coords.longitude
        })
      })
    }
  }, [latLng])
}
```

å½“è·å–ç»çº¬åº¦æƒé™è¢«å…è®¸ï¼Œå°†ä¼šè¿”å›å½“å‰ç»çº¬åº¦ï¼Œå°±å¯ä»¥è¯·æ±‚å¤©æ°”æ¥å£äº†

```jsx
import {useEffect, useState} from 'react'

export default function Weather() {
  const [latLng, setLatLng] = useState({})
  const [data, setData] = useState(null)
  useEffect(() => {
    if (!latLng.lat && !latLng.long) {
      navigator.geolocation.getCurrentPosition(function (position) {
        setLatLng({
          lat: position.coords.latitude,
          long: position.coords.longitude
        })
      })
      return
    }
    if (!data) {
      fetch(
        `${import.meta.env.VITE_APP_API_URL}/weather/?lat=${latLng.lat}&lon=${
          latLng.long
        }&units=metric&APPID=${import.meta.env.VITE_APP_API_KEY}`
      )
        .then((res) => res.json())
        .then((result) => setData(result))
    }
  }, [latLng])
}
```

![CxW8Dv](https://cdn.jsdelivr.net/gh/manonicu/pics@master/uPic/CxW8Dv.jpg)

## Source Code

[ã€Source Codeã€‘](https://github.com/rebelchris/popup-extension)
